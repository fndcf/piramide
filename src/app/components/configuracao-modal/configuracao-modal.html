<div class="modal-overlay" *ngIf="mostrar" (click)="fecharModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3>âš™ï¸ ConfiguraÃ§Ãµes de Desafio</h3>
      <button class="btn-close" (click)="fecharModal()">Ã—</button>
    </div>
    
    <div class="modal-body">
      <p class="subtitle">Configure ATÃ‰ qual posiÃ§Ã£o os jogadores podem desafiar livremente atÃ© o topo</p>
      
      <form (ngSubmit)="onSalvar()" #configForm="ngForm">
        <div class="form-group">
          <label>PosiÃ§Ã£o Limite para Desafio Livre (ATÃ‰):</label>
          <select [(ngModel)]="posicaoLimite" 
                  name="posicaoLimite"
                  class="form-control"
                  [disabled]="loading">
            <option value="1">Nenhum (apenas regra original)</option>
            <option value="2">ATÃ‰ o 2Âº colocado</option>
            <option value="3">ATÃ‰ o 3Âº colocado</option>
            <option value="4">ATÃ‰ o 4Âº colocado</option>
            <option value="5">ATÃ‰ o 5Âº colocado</option>
            <option value="6">ATÃ‰ o 6Âº colocado</option>
            <option value="7">ATÃ‰ o 7Âº colocado</option>
            <option value="8">ATÃ‰ o 8Âº colocado</option>
            <option value="10">ATÃ‰ o 10Âº colocado</option>
          </select>
          <small class="help-text">
            Jogadores do 2Âº ATÃ‰ a posiÃ§Ã£o escolhida podem desafiar atÃ© o 1Âº lugar
          </small>
        </div>
        
        <div class="preview-section">
          <h4>ğŸ“‹ SimulaÃ§Ã£o com a ConfiguraÃ§Ã£o Escolhida</h4>
          <div class="example-card">
            <div *ngIf="getExemplosConfiguracao().temExcecao">
              <div class="exemplo-posicao can-challenge">
                <strong>PosiÃ§Ãµes que PODEM desafiar livremente:</strong>
                <p class="positions-list">
                  <span *ngFor="let pos of getExemplosConfiguracao().posicaoComExcecao; let isLast = last">
                    {{ pos }}Âº{{ !isLast ? ', ' : '' }}
                  </span>
                </p>
                <ul>
                  <li>âœ… <strong>Regra original:</strong> Mesma base (Ã  esquerda) + base acima (Ã  direita)</li>
                  <li>âœ… <strong>EXCEÃ‡ÃƒO ESPECIAL:</strong> Podem desafiar qualquer posiÃ§Ã£o atÃ© o 1Âº lugar</li>
                </ul>
              </div>
              
              <div class="regra-explicacao">
                <p><strong>ğŸ¯ Resumo da ConfiguraÃ§Ã£o:</strong></p>
                <p>â€¢ <strong>1Âº lugar:</strong> NÃ£o precisa desafiar ninguÃ©m</p>
                <p>â€¢ <strong>2Âº ao {{ posicaoLimite }}Âº:</strong> Podem desafiar atÃ© o 1Âº lugar</p>
                <p>â€¢ <strong> Os que vem apÃ³s o {{ posicaoLimite }}Âº </strong> Apenas regra original</p>
              </div>
            </div>
            
            <div *ngIf="!getExemplosConfiguracao().temExcecao">
              <div class="exemplo-posicao original-only">
                <p><strong>ğŸ¯ Apenas Regra Original Aplicada:</strong></p>
                <ul>
                  <li>âœ… <strong>Mesma base:</strong> Duplas Ã  esquerda</li>
                  <li>âœ… <strong>Base acima:</strong> Duplas Ã  direita</li>
                  <li>âŒ <strong>Nenhuma exceÃ§Ã£o:</strong> NinguÃ©m pode desafiar livremente atÃ© o topo</li>
                </ul>
              </div>
            </div>
          </div>
        </div>
        
        <div class="alert-message" *ngIf="mensagem" [class]="tipoMensagem">
          {{ mensagem }}
        </div>
        
        <div class="form-actions">
          <button 
            type="button" 
            class="btn-cancelar" 
            (click)="fecharModal()"
            [disabled]="loading">
            Cancelar
          </button>
          <button 
            type="submit" 
            class="btn-salvar" 
            [disabled]="loading">
            <span *ngIf="loading">Salvando...</span>
            <span *ngIf="!loading">Salvar ConfiguraÃ§Ã£o</span>
          </button>
        </div>
      </form>
    </div>
  </div>
</div>